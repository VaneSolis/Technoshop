{"version":3,"file":"ItemListContainer-Clo87OMf.js","sources":["../../src/components/Catalogo/ItemListContainer.jsx"],"sourcesContent":["import { useNavigate, useParams } from \"react-router-dom\";\nimport './ItemListCont.css'\nimport { useEffect, useState, useMemo } from \"react\";\nimport { collection, getDocs, query, where } from \"firebase/firestore\";\nimport { db } from '../../Firebase/Config';\n\nexport default function ProductsComponent() {\n    const navigate = useNavigate();\n    const { category } = useParams();\n    const [state, setState] = useState({\n        products: [],\n        loading: true,\n        error: null\n    });\n\n    // Memoizar la query de Firebase\n    const productsQuery = useMemo(() => {\n        const productsRef = collection(db, \"productos\");\n        return category ? \n            query(productsRef, where(\"category\", \"==\", category)) : \n            productsRef;\n    }, [category]);\n\n    useEffect(() => {\n        let mounted = true;\n\n        const fetchProducts = async () => {\n            if (!mounted) return;\n\n            setState(prev => ({ ...prev, loading: true, error: null }));\n            \n            try {\n                const snapshot = await getDocs(productsQuery);\n                \n                if (!mounted) return;\n\n                const productsData = snapshot.docs.map(doc => ({\n                    ...doc.data(),\n                    id: doc.id\n                }));\n\n                setState({\n                    products: productsData,\n                    loading: false,\n                    error: null\n                });\n            } catch (err) {\n                console.error(\"Error fetching products:\", err);\n                if (mounted) {\n                    setState({\n                        products: [],\n                        loading: false,\n                        error: \"Error al cargar los productos. Por favor, intente nuevamente.\"\n                    });\n                }\n            }\n        };\n\n        fetchProducts();\n\n        return () => {\n            mounted = false;\n        };\n    }, [productsQuery]);\n\n    const handleClick = (id) => {\n        if (id) {\n            navigate(`/product/${id}`, { replace: true });\n        }\n    };\n\n    const { products, loading, error } = state;\n\n    if (loading) {\n        return (\n            <main className=\"contbig loading\">\n                <div className=\"loading-container\">\n                    <div className=\"loading-spinner\"></div>\n                    <p>Cargando productos...</p>\n                </div>\n            </main>\n        );\n    }\n\n    if (error) {\n        return (\n            <main className=\"contbig error\">\n                <div className=\"error-container\">\n                    <p>{error}</p>\n                    <button onClick={() => {\n                        setState(prev => ({ ...prev, loading: true, error: null }));\n                        const fetchProducts = async () => {\n                            try {\n                                const snapshot = await getDocs(productsQuery);\n                                const productsData = snapshot.docs.map(doc => ({\n                                    ...doc.data(),\n                                    id: doc.id\n                                }));\n                                setState({\n                                    products: productsData,\n                                    loading: false,\n                                    error: null\n                                });\n                            } catch (err) {\n                                console.error(\"Error fetching products:\", err);\n                                setState({\n                                    products: [],\n                                    loading: false,\n                                    error: \"Error al cargar los productos. Por favor, intente nuevamente.\"\n                                });\n                            }\n                        };\n                        fetchProducts();\n                    }}>\n                        Reintentar\n                    </button>\n                </div>\n            </main>\n        );\n    }\n\n    return (\n        <main className=\"contbig\">\n            <h1>{category ? `${category}` : 'Descubre nuestros productos'}</h1>\n            {!products || products.length === 0 ? (\n                <p className=\"no-products\">No hay productos disponibles en esta categor√≠a.</p>\n            ) : (\n                <section className=\"prodcards\">\n                    {products.map(product => (\n                        <article key={product.id} className=\"product-card\">\n                            <div className=\"img-container\">\n                                <img \n                                    src={product.image} \n                                    alt={product.title}\n                                    loading=\"lazy\"\n                                    onError={(e) => {\n                                        e.target.src = '/placeholder-image.jpg';\n                                    }}\n                                />\n                            </div>\n                            <div className=\"product-info\">\n                                <h4>{product.title}</h4>\n                                <p className=\"price\">$ {product.price?.toLocaleString()}</p>\n                                <button \n                                    onClick={() => handleClick(product.id)}\n                                    aria-label={`Ver detalles de ${product.title}`}\n                                >\n                                    Ver detalles\n                                </button>\n                            </div>\n                        </article>\n                    ))}\n                </section>\n            )}\n        </main>\n    );\n}"],"names":["ProductsComponent","navigate","useNavigate","category","useParams","state","setState","useState","products","loading","error","productsQuery","useMemo","productsRef","collection","db","query","where","useEffect","mounted","__async","this","prev","__spreadProps","__spreadValues","snapshot","getDocs","productsData","docs","map","doc","data","id","err","console","fetchProducts","className","children","jsxs","jsx","onClick","length","jsxRuntimeExports","product","src","image","alt","title","onError","e","target","_a","price","toLocaleString","replace"],"mappings":"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"}